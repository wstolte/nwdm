[
["index.html", "Documentation North Sea Wadden Sea validation database at Deltares 1 Background", " Documentation North Sea Wadden Sea validation database at Deltares Willem Stolte 2020-07-03 1 Background Several projects have a need for model validation data for the (Greater) North Sea. Current modeling efforts comprise hydrodynamics, sediment, water quality and ecological modeling. Validation data therefore comprise a large number of data from different origin, and different standards. The objective of this memo is to propose and agree on a common data format for validation data for North Sea models: both hydrodynamics, water quality and ecology. "],
["workflow-description.html", "2 Workflow description 2.1 Data in 2.2 Data out 2.3 Locations 2.4 Minimal metadata: Combination of locations and parameters 2.5 Observations", " 2 Workflow description 2.1 Data in Data from different sources are retrieved, harmonized and stored locally in a PostGreSQL/PostGIS database. This is done by scripting, so that it is easy to update. Data are then made available via a Geoserver for easy retrieval by users. For use in validation scripts, the data can be queried and downloaded in a ready-to-use form via scripting in Matlab, Python or R. This document describes this process. 2.2 Data out The Geoserver provides a Web Feature Service (WFS). The service is called by a URL. In the URL, specifications and criteria can be included. Currently, three tables are available in the Geoserver: Locations Locations and parameters Observations - all observations (1.4 million). It is unwise to download all data in the observations table at once. The first 50 records can be downloaded with https://marineprojects.openearth.nl/geoserver/NWDM/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=NWDM:measurement_view&amp;outputFormat=csv&amp;maxFeatures=50 2.3 Locations All unique locations in the database. The table can be downloaded using the url: https://marineprojects.openearth.nl/geoserver/NWDM/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=NWDM:location&amp;outputFormat=csv Below is a map with all locations currently in the database. locs &lt;- readr::read_csv(&quot;https://marineprojects.openearth.nl/geoserver/NWDM/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=NWDM:location&amp;outputFormat=csv&quot;) %&gt;% sf::st_as_sf(coords = c(&quot;x&quot;,&quot;y&quot;), crs = 25831) %&gt;% sf::st_transform(4326) leaflet::leaflet(locs) %&gt;% addTiles() %&gt;% addCircleMarkers(label = ~location_code) 2.4 Minimal metadata: Combination of locations and parameters All unique combinations of location and parameters. The table can be downloaded completeley using the url: https://marineprojects.openearth.nl/geoserver/NWDM/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=NWDM:p35location&amp;outputFormat=csv The following parameters are currently loaded in the database: parameters &lt;- readr::read_csv(&quot;https://marineprojects.openearth.nl/geoserver/NWDM/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=NWDM:p35location&amp;outputFormat=csv&quot;) %&gt;% distinct(p35code, p35preflabel) knitr::kable(parameters) p35code p35preflabel EPC00168 Water body pH WATERTEMP ITS-90 water temperature EPC00001 Water body salinity EPC00211 Silicate in the sediment EPC00006 Water body nitrite EPC00186 Water body dissolved phosphorus EPC00004 Water body nitrate EPC00212 Water body particulate nitrogen EPC00157 Water body particulate organic carbon {POC} EPC00002 Water body dissolved oxygen concentration EPC00160 Water body dissolved nitrogen EPC00190 Water body dissolved organic carbon {DOC} 2.5 Observations All observations. This table should not be downloaded completely. It is big and will grow bigger over time, and it is unlikely that you will need the complete table. The table can be easily subsetted by a so-called CQL-query in the wfs request (url). This is described in the next part. "],
["building-a-query.html", "3 Building a query 3.1 Structure of a wfs request 3.2 Select parameters and locations", " 3 Building a query 3.1 Structure of a wfs request The wfs request for the location table looks like this: structure &lt;- httr::parse_url(&quot;https://marineprojects.openearth.nl/geoserver/NWDM/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=NWDM:location&amp;outputFormat=csv&quot;) knitr::kable(paste0(paste(names(structure),paste0(structure),sep=&quot;=&quot;))) x scheme=https hostname=marineprojects.openearth.nl port=NULL path=geoserver/NWDM/ows query=list(service = “WFS”, version = “1.0.0”, request = “GetFeature”, typeName = “NWDM:location”, outputFormat = “csv”) params=NULL fragment=NULL username=NULL password=NULL The interesting part of the wfs request is the query. In the above example, the query contains information on the service and version (WFS 1.0.0), request (GetFeature), and the table or “typeName” (refers to database schema “NWDM”, and table “location”) knitr::kable(paste0(paste(names(structure$query),paste0(structure$query),sep=&quot;=&quot;))) x service=WFS version=1.0.0 request=GetFeature typeName=NWDM:location outputFormat=csv In the query part, we can add an element called CQL-query. 3.2 Select parameters and locations Below is an example where only data are requested that contain data on “water body nitrate” at locations “DOOVBWT” (this is a station in the Wadden Sea) url = &quot;https://marineprojects.openearth.nl/geoserver/NWDM/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=NWDM%3Ameasurement_view&amp;cql_filter=%28p35preflabel%3D%27Water%20body%20nitrate%27%20and%20location_code%3D%27DOOVBWT%27%29&amp;outputFormat=csv&quot; structure &lt;- httr::parse_url(url) knitr::kable(paste0(paste(names(structure),paste0(structure),sep=&quot;=&quot;))) x scheme=https hostname=marineprojects.openearth.nl port=NULL path=geoserver/NWDM/ows query=list(service = “WFS”, version = “1.0.0”, request = “GetFeature”, typeName = “NWDM:measurement_view”, cql_filter = “(p35preflabel=‘Water body nitrate’ and location_code=‘DOOVBWT’)”, outputFormat = “csv”) params=NULL fragment=NULL username=NULL password=NULL "],
["more-on-wfs.html", "4 More on WFS", " 4 More on WFS Full documentation is found here: https://docs.geoserver.org/latest/en/user/services/wfs/reference.html The capabilities of the used geoserver schema can be requested by: https://marineprojects.openearth.nl/geoserver/NWDM/ows?service=WFS&amp;version=1.0.0&amp;request=GetCapabilities A description of the featuretypes (layers) can be requested by: https://marineprojects.openearth.nl/geoserver/NWDM/wfs?request=DescribeFeatureType "]
]
